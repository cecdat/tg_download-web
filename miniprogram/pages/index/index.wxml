<view class="container">
  <view class="header-section">
    <view class="title-main">æ§åˆ¶å°</view>
    <view class="title-sub">å®æ—¶ç›‘æ§ç³»ç»ŸçŠ¶æ€ä¸ä¸‹è½½è¿›åº¦</view>
  </view>

  <!-- ç³»ç»ŸçŠ¶æ€å¡ç‰‡ -->
  <view class="card">
    <view class="flex-between mb-24">
      <view class="section-title">ç³»ç»ŸçŠ¶æ€</view>
      <view class="refresh-btn" bindtap="refreshData">
        <text class="loading-spinner" wx:if="{{loading}}"></text>
        <text wx:else>ğŸ”„ åˆ·æ–°</text>
      </view>
    </view>
    
    <view class="status-grid-compact">
      <view class="status-item-mini">
        <text class="status-icon-mini bg-blue">ğŸ’¾</text>
        <view class="status-info-mini">
          <text class="status-label-mini">ç£ç›˜ ({{diskUsed}}G / {{diskTotal}}G)</text>
          <text class="status-value-mini" style="color: {{diskPercent > 90 ? '#E11D48' : '#1E293B'}}">{{diskPercent}}%</text>
        </view>
      </view>
      
      <view class="status-item-mini">
        <text class="status-icon-mini bg-purple">ğŸ§ </text>
        <view class="status-info-mini">
          <text class="status-label-mini">å†…å­˜ ({{memoryUsed}}G / {{memoryTotal}}G)</text>
          <text class="status-value-mini" style="color: {{memoryPercent > 90 ? '#E11D48' : '#1E293B'}}">{{memoryPercent}}%</text>
        </view>
      </view>
      
      <view class="status-item-mini">
        <text class="status-icon-mini bg-pink">âš¡</text>
        <view class="status-info-mini">
          <text class="status-label-mini">ç³»ç»Ÿè´Ÿè½½</text>
          <text class="status-value-mini">{{systemLoad}}</text>
        </view>
      </view>
      
      <view class="status-item-mini">
        <text class="status-icon-mini bg-orange">â±ï¸</text>
        <view class="status-info-mini">
          <text class="status-label-mini">è¿è¡Œæ—¶é•¿</text>
          <text class="status-value-mini" style="font-size: 24rpx;">{{uptime}}</text>
        </view>
      </view>
    </view>
  </view>
  
  <!-- æ´»è·ƒä¸‹è½½å¡ç‰‡ -->
  <view class="card">
    <view class="section-title">æ´»è·ƒä¸‹è½½</view>
    
    <view wx:if="{{loading && activeDownloads.length === 0}}" class="flex-center py-40">
      <view class="loading-spinner"></view>
    </view>
    
    <view wx:elif="{{activeDownloads.length > 0}}">
      <view class="download-item mb-20 {{item.status === 'waiting' ? 'waiting-mode' : ''}}" wx:for="{{activeDownloads}}" wx:key="index">
        <view class="flex-between mb-10">
          <view class="download-info">
            <view class="font-bold text-md truncate">{{item.name}}</view>
            <view class="flex-row mt-10">
              <view class="badge badge-info">{{item.channel_name || '-'}}</view>
              <view class="text-xs text-muted ml-20" wx:if="{{item.status !== 'waiting'}}">âš¡ {{item.speed}}</view>
              <view class="text-xs text-warning ml-20" wx:else>â³ æ’é˜Ÿç­‰å¾…ä¸­...</view>
            </view>
          </view>
          <view class="text-primary font-bold" wx:if="{{item.status !== 'waiting'}}">{{item.percentage}}%</view>
          <view class="text-warning font-bold" wx:else>ç­‰å¾…ä¸­</view>
        </view>
        
        <view class="progress-container" wx:if="{{item.status !== 'waiting'}}">
          <view class="progress-filler" style="width: {{item.percentage}}%"></view>
        </view>
        
        <view class="flex-between text-xs text-muted mt-10">
          <text wx:if="{{item.status !== 'waiting'}}">{{item.downloaded}} MB / {{item.total}} MB</text>
          <text wx:else>å½“å‰å…±æœ‰ {{activeDownloads.length}} ä¸ªä»»åŠ¡</text>
          <text>{{item.status === 'waiting' ? 'ç­‰å¾…èµ„æº' : 'æ­£åœ¨ä¸‹è½½'}}</text>
        </view>
      </view>
    </view>
    
    <view wx:else class="empty-state mt-40">
      <view class="empty-icon">â˜•</view>
      <text class="text-muted">å½“å‰æš‚æ— æ´»è·ƒä¸‹è½½ä»»åŠ¡</text>
    </view>
  </view>
</view>
